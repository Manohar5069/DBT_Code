{{config(
  materialized = 'table',
  schema='reporting_layer'  
        )
}}

WITH LOANS_DATA AS (
    SELECT
        *
    FROM
         {{source('TRANSFORM','DEMO_LOANS_SFTP')}}
)

SELECT 
ENCOMPASSID, 
BLTV, 
BORROWERCOUNT, 
CHANNEL, 
CLOSINGBILLINGDATE, 
CONSTRUCTIONLOANINDICATOR, 
CREDITSCORETOUSE, 
LOANCREATEDDATEUTC, 
LOANIDNUMBER, 
LOANSOURCE, 
MATURITYDATE, 
MERSNUMBER, 
MOM, 
MORTGAGETYPE, 
OCCUPANCYTYPE, 
PMIINDICATOR, 
CORPORATEAPPROVALDATE, 
CORPORATEAPPROVEDBY, 
CURRENTLOCKDATE, 
DISCLOSURETYPE, 
LOANPROGRAM, 
PLANCODE, 
CLTV, 
DEBTTOINCOMERATIO, 
INTERESTRATE, 
LIENSTATUS, 
LOANPURPOSE, 
LOANTERM, 
LOANTYPE, 
PROPERTYTYPE, 
PROPERTYVALUE, 
STATECODE, 
TOTALLOANCOSTS, 
PROCESS_DATE, 
FILE_NAME,
_FIVETRAN_SYNCED
FROM
LOANS_DATA
